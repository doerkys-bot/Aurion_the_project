<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aurion Vorhof</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      background: url('https://doerkys-bot.github.io/Aurion_the_poroject/wald.jpeg') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: sans-serif;
      color: white;
    }
    .scene {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2em;
      flex-wrap: wrap;
    }
    .poster {
      background: rgba(0,0,0,0.6);
      padding: 1em;
      border-radius: 8px;
      max-width: 200px;
      text-align: center;
      font-size: 0.9em;
      color: #ffcc00;
    }
    .tent {
      background: rgba(255,255,255,0.15);
      padding: 2em 3em;
      border-radius: 50%;
      text-align: center;
      font-size: 1.5em;
      font-weight: bold;
      color: white;
      text-decoration: none;
      animation: breathe 4s ease-in-out infinite;
      box-shadow: 0 0 20px rgba(255,255,255,0.4);
    }
    @keyframes breathe {
      0%   { transform: scale(1); }
      50%  { transform: scale(1.08); }
      100% { transform: scale(1); }
    }
    #vorhof-counter {
      margin-top: 2em;
      text-align: center;
      color: #eee;
    }
    #vorhof-counter strong {
      color: #ffcc00;
    }
    #host-toggle {
      background:#222; color:#ffcc00; border:1px solid #ffcc00;
      padding:0.6em 1.2em; border-radius:6px; cursor:pointer; font-size:0.9em;
    }
    #host-hint {
      margin-top:0.6em; font-size:0.85em; color:#aaa;
    }
  </style>
</head>
<body>
  <div class="scene">
    <div class="poster" id="posterA">Lade Plakat Aâ€¦</div>
    <a class="tent" href="https://doerkys-bot.github.io/Aurion_the_poroject/aurion_inner.html">Aurion</a>
    <div class="poster" id="posterB">Lade Plakat Bâ€¦</div>
  </div>

  <!-- BesucherzÃ¤hler -->
  <section id="vorhof-counter">
    ðŸšª Besucher im Vorhof: <strong id="count">â€“</strong><br>
    <button id="host-toggle">Ich bin der Gastgeber (eigene Besuche nicht zÃ¤hlen)</button>
    <div id="host-hint">Status: unbekannt</div>
  </section>

  <script>
    async function loadPoster(id, url) {
      try {
        const res = await fetch(url);
        const data = await res.json();
        document.getElementById(id).textContent = data.text || data.title || JSON.stringify(data);
      } catch (e) {
        document.getElementById(id).textContent = "Plakat konnte nicht geladen werden.";
      }
    }
    loadPoster("posterA", "https://doerkys-bot.github.io/Aurion_the_poroject/pop_up_a.json");
    loadPoster("posterB", "https://doerkys-bot.github.io/Aurion_the_poroject/pop_up_b.json");

    // BesucherzÃ¤hler
    (function() {
      const NAMESPACE = 'auriontheproject.eu';
      const KEY = 'vorhof';
      const COUNT_API = `https://api.countapi.xyz`;
      const countEl = document.getElementById('count');
      const toggleBtn = document.getElementById('host-toggle');
      const hintEl = document.getElementById('host-hint');
      const HOST_KEY = 'aurion_host_exclude';

      const isHost = () => localStorage.getItem(HOST_KEY) === '1';
      const setHost = (v) => localStorage.setItem(HOST_KEY, v ? '1' : '0');

      function updateHostUI() {
        hintEl.textContent = 'Status: ' + (isHost()
          ? 'Gastgeber (eigene Besuche werden NICHT gezÃ¤hlt)'
          : 'Gast (Besuche werden gezÃ¤hlt)');
        toggleBtn.style.opacity = isHost() ? 0.7 : 1;
      }

      async function ensureCounter() {
        try {
          await fetch(`${COUNT_API}/create?namespace=${encodeURIComponent(NAMESPACE)}&key=${encodeURIComponent(KEY)}`);
        } catch (e) {}
      }

      async function getCount() {
        try {
          const r = await fetch(`${COUNT_API}/get/${encodeURIComponent(NAMESPACE)}/${encodeURIComponent(KEY)}`);
          const data = await r.json();
          countEl.textContent = (data && typeof data.value === 'number') ? data.value : 'â€“';
        } catch (e) {
          countEl.textContent = 'â€“';
        }
      }

      async function maybeIncrement() {
        if (isHost()) {
          await getCount();
          return;
        }
        try {
          const r = await fetch(`${COUNT_API}/hit/${encodeURIComponent(NAMESPACE)}/${encodeURIComponent(KEY)}`);
          const data = await r.json();
          countEl.textContent = (data && typeof data.value === 'number') ? data.value : 'â€“';
        } catch (e) {
          await getCount();
        }
      }

      toggleBtn.addEventListener('click', async function() {
        setHost(!isHost());
        updateHostUI();
        await getCount();
      });

      (async function init() {
        updateHostUI();
        await ensureCounter();
        await maybeIncrement();
      })();
    })();
  </script>
</body>
</html>


